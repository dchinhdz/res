<html>
  <head>
    <title>TEST CLIENT</title>
    <style>
      * {margin: 10px;background-color: #000;color:#fff}
      #log {border: 4px solid #ff0;overflow-y: scroll;max-height: 50vh}
    </style>
  </head>
  <body>
    <h2>TEST WEBSOCKET //</h2>
    <div id="log"></div>
    <button type="button" onclick="clearLog();">CLEAR</button>
    <button type="button" onclick="emitS('str');">STRING</button>
    <button type="button" onclick="emitS('obj');">OBJECT</button>
    <button type="button" onclick="emitS('bin');">BINARY</button>
    <button type="button" onclick="emitS('move');">MOVE</button>
    <button type="button" onclick="emitS('cmd');">CMD</button>
    <script type="module">
      import {Socket} from './Socket.js';
      import {Act} from './Act.js';
      const ws = new Socket('wss://echo.websocket.org');
      const div = document.getElementById("log");
      function log(text) {
        let iv = document.createElement("div");
        iv.textContent = `ðŸ“© ${text}`;
        div.appendChild(iv);
      }
      function clearLog() {
        div.innerHTML = '';
        log('clean log...');
      }
      function emitS(type) {
        if (ws.readyState !== 1) return log('Websocket chÆ°a sáºµn sÃ ng!');
        if (type === 'move') {
          ws.emit(Act.move(10, 133.4, 23.6));
          log('EMIT: MOVE');
        } else if(type === 'obj') {
          ws.emit(JSON.stringify({a: 1, b: 2}));
          log('EMIT: JSON');
        } else if(type === 'str') {
          ws.emit('Hello String!');
          log('EMIT: STRING');
        } else if(type === 'bin') {
          ws.emit(Act.str(20, 'Hello Bytes'));
          log('EMIT: BINARY');
        } else if(type === 'cmd') {
          ws.emit(Act.cmd(30, 5351));
          log('EMIT: CMD');
        } else {
          log('Dá»¯ liá»‡u gá»­i khÃ´ng Ä‘Ãºng!');
        }
      }
      try {
        ws.on("open", () => log('âœ… CONNECTED!'));
        ws.on("error", (e) => log('âš ï¸ ERROR!'));
        ws.on("close", () => log('âŒ DISCONNECT!'));
        ws.on("message", (e) => {
          log('RECEIVE: '+e.data);
        });
      } catch {
        log('Syntax Error...'); 
      }
    </script>
  </body>
</html>
